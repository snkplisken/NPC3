<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NPC BODYCAM // CIVILIAN_04</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            overflow: hidden; 
            background: #000;
            font-family: 'Share Tech Mono', 'Courier New', monospace;
        }
        
        canvas { display: block; }
        
        /* Main UI Overlay */
        #ui-layer {
            position: fixed;
            top: 0; left: 0; 
            width: 100%; height: 100%;
            pointer-events: none;
            padding: 20px 30px;
            color: rgba(255, 255, 255, 0.85);
            text-shadow: 
                0 0 2px rgba(0, 0, 0, 0.9),
                0 0 10px rgba(0, 0, 0, 0.5);
            font-size: 13px;
            letter-spacing: 0.5px;
        }
        
        /* Top Bar */
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .cam-info {
            line-height: 1.6;
        }
        
        .cam-id {
            font-size: 16px;
            font-weight: bold;
            color: #fff;
        }
        
        .location {
            color: rgba(255, 255, 255, 0.7);
            font-size: 11px;
        }
        
        .rec-area {
            text-align: right;
            line-height: 1.6;
        }
        
        .rec-indicator {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 8px;
            font-size: 14px;
            font-weight: bold;
        }
        
        .rec-dot {
            width: 10px;
            height: 10px;
            background: #ff0000;
            border-radius: 50%;
            box-shadow: 0 0 8px #ff0000;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        #timestamp {
            font-size: 15px;
            color: #fff;
            font-variant-numeric: tabular-nums;
        }
        
        /* Bottom Bar */
        .bottom-bar {
            position: absolute;
            bottom: 20px;
            left: 30px;
            right: 30px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }
        
        .status-area {
            line-height: 1.6;
        }
        
        #npc-status {
            font-size: 14px;
            color: #4a4;
            text-transform: uppercase;
        }
        
        #npc-status.panic {
            color: #f44;
            animation: statusBlink 0.3s infinite;
        }
        
        #npc-status.cowering {
            color: #fa4;
        }
        
        @keyframes statusBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .vitals {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
        }
        
        .battery-area {
            text-align: right;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
        }
        
        .battery-bar {
            width: 50px;
            height: 8px;
            border: 1px solid rgba(255, 255, 255, 0.5);
            margin-top: 4px;
            margin-left: auto;
        }
        
        .battery-fill {
            height: 100%;
            background: #4a4;
            width: 78%;
        }
        
        /* Crosshair / Center marker */
        .center-mark {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 4px;
            height: 4px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
        }
        
        /* Corner brackets */
        .corner {
            position: fixed;
            width: 40px;
            height: 40px;
            border: 2px solid rgba(255, 255, 255, 0.15);
        }
        
        .corner-tl { top: 15%; left: 15%; border-right: none; border-bottom: none; }
        .corner-tr { top: 15%; right: 15%; border-left: none; border-bottom: none; }
        .corner-bl { bottom: 15%; left: 15%; border-right: none; border-top: none; }
        .corner-br { bottom: 15%; right: 15%; border-left: none; border-top: none; }
        
        /* Alert overlay */
        #alert-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            background: radial-gradient(ellipse at center, transparent 50%, rgba(255, 0, 0, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        #alert-overlay.active {
            opacity: 1;
            animation: alertPulse 0.5s infinite;
        }
        
        @keyframes alertPulse {
            0%, 100% { background: radial-gradient(ellipse at center, transparent 50%, rgba(255, 0, 0, 0.15) 100%); }
            50% { background: radial-gradient(ellipse at center, transparent 50%, rgba(255, 0, 0, 0.05) 100%); }
        }
        
        /* Loading */
        #loading {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #666;
            font-family: 'Share Tech Mono', monospace;
            z-index: 100;
        }
        
        .loading-text {
            font-size: 14px;
            letter-spacing: 2px;
            animation: loadingBlink 1s infinite;
        }
        
        @keyframes loadingBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }
        
        .loading-bar {
            width: 200px;
            height: 2px;
            background: #222;
            margin-top: 20px;
            overflow: hidden;
        }
        
        .loading-fill {
            width: 30%;
            height: 100%;
            background: #444;
            animation: loadingSlide 1s infinite;
        }
        
        @keyframes loadingSlide {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(400%); }
        }
        
        /* Static noise overlay */
        #noise-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            opacity: 0.03;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%' height='100%' filter='url(%23noise)'/%3E%3C/svg%3E");
            mix-blend-mode: overlay;
        }
    </style>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/",
                "cannon-es": "https://unpkg.com/cannon-es@0.20.0/dist/cannon-es.js"
            }
        }
    </script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading">
        <div class="loading-text">INITIALIZING BODYCAM FEED...</div>
        <div class="loading-bar">
            <div class="loading-fill"></div>
        </div>
    </div>
    
    <!-- Alert Overlay -->
    <div id="alert-overlay"></div>
    
    <!-- Noise Overlay -->
    <div id="noise-overlay"></div>
    
    <!-- UI Layer -->
    <div id="ui-layer">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="cam-info">
                <div class="cam-id">CAM_04 [NPC_CIVILIAN]</div>
                <div class="location">LOC: ST_ANDREWS_AVE / SECTOR_7</div>
            </div>
            <div class="rec-area">
                <div class="rec-indicator">
                    <div class="rec-dot"></div>
                    <span>REC</span>
                </div>
                <div id="timestamp">00:00:00:00</div>
            </div>
        </div>
        
        <!-- Corner Brackets -->
        <div class="corner corner-tl"></div>
        <div class="corner corner-tr"></div>
        <div class="corner corner-bl"></div>
        <div class="corner corner-br"></div>
        
        <!-- Center Mark -->
        <div class="center-mark"></div>
        
        <!-- Bottom Bar -->
        <div class="bottom-bar">
            <div class="status-area">
                <div>STATUS: <span id="npc-status">IDLE</span></div>
                <div class="vitals">HR: <span id="heart-rate">72</span> BPM | TEMP: 36.8Â°C</div>
            </div>
            <div class="battery-area">
                <div>BATT: 78%</div>
                <div class="battery-bar">
                    <div class="battery-fill"></div>
                </div>
            </div>
        </div>
    </div>
    
    <script type="module" src="./main.js"></script>
    
    <!-- UI Update Script -->
    <script>
        // Expose functions for main.js to call
        window.updateNPCStatus = function(status) {
            const el = document.getElementById('npc-status');
            const alertOverlay = document.getElementById('alert-overlay');
            
            el.textContent = status;
            el.className = '';
            
            if (status === 'PANIC') {
                el.classList.add('panic');
                alertOverlay.classList.add('active');
            } else if (status === 'COWERING') {
                el.classList.add('cowering');
                alertOverlay.classList.remove('active');
            } else {
                alertOverlay.classList.remove('active');
            }
        };
        
        // Simulated heart rate based on status
        let baseHR = 72;
        let targetHR = 72;
        let currentHR = 72;
        
        setInterval(() => {
            const status = document.getElementById('npc-status').textContent;
            if (status === 'PANIC') {
                targetHR = 140 + Math.random() * 30;
            } else if (status === 'COWERING') {
                targetHR = 100 + Math.random() * 20;
            } else {
                targetHR = 72 + Math.random() * 10;
            }
            
            currentHR += (targetHR - currentHR) * 0.1;
            document.getElementById('heart-rate').textContent = Math.round(currentHR);
        }, 200);
    </script>
</body>
</html>
